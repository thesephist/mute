"use strict";var $=document.querySelector.bind(document),$$=document.querySelectorAll.bind(document),MuteUtils={eventAdder:function(t,e,n){for(var r=$$(t)||[],o=r.length,c=0;c<o;c++)r[c].addEventListener(e,n);return r},extendObject:function(t,e){return Object.keys(e).forEach(function(n){t[n]=e[n]}),t},getLocation:function(t){var e=t.getBoundingClientRect();return extendObject(e,{width:e.right-e.left,height:e.bottom-e.top}),e},nodeListToArray:function(t){return Array.prototype.slice.call(t)}};
"use strict";var Mute={muteMode:0,exemptDomains:[],currentDomain:null,el:{excludeOnButton:$(".excluder .on"),excludeOffButton:$(".excluder .off"),muteButton:$(".muter .mute"),stopButton:$(".muter .stop")},ev:{"click .excluder .on":"excludeSite","click .excluder .off":"includeSite","click .muter .mute":"setMute","click .muter .stop":"setStop"},f:{setDomainName:function(e){var t=void 0;chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(u){t=u[0].url;var n=document.createElement("a");n.setAttribute("href",t),Mute.currentDomain=n.hostname,e&&e()})},toast:function(e){},excludeSite:function(e){Mute.currentDomain&&Mute.exemptDomains.indexOf(Mute.currentDomain)==-1&&Mute.exemptDomains.push(Mute.currentDomain),this.setSettings(),this.render()},includeSite:function(e){if(Mute.currentDomain){var t=Mute.exemptDomains.indexOf(Mute.currentDomain);t>-1&&Mute.exemptDomains.splice(t,1),this.setSettings(),this.render()}},setMute:function(e){Mute.muteMode=0,this.setSettings(),this.render()},setStop:function(e){Mute.muteMode=1,this.setSettings(),this.render()},render:function(){switch(Mute.muteMode){case 0:Mute.el.stopButton.classList.remove("active"),Mute.el.muteButton.classList.add("active");break;case 1:Mute.el.muteButton.classList.remove("active"),Mute.el.stopButton.classList.add("active")}Mute.currentDomain&&Mute.exemptDomains.indexOf(Mute.currentDomain)>-1?(Mute.el.excludeOffButton.classList.remove("active"),Mute.el.excludeOnButton.classList.add("active")):(Mute.el.excludeOnButton.classList.remove("active"),Mute.el.excludeOffButton.classList.add("active"))},getSettings:function(e){return chrome.storage.sync.get({muteMode:0,exemptDomains:[]},function(e){Mute.muteMode=e.muteMode,Mute.exemptDomains=e.exemptDomains}),e&&e(),{muteMode:Mute.muteMode,exemptDomains:Mute.exemptDomains}},setSettings:function(e){chrome.storage.sync.set({muteMode:Mute.muteMode,exemptDomains:Mute.exemptDomains},function(){this.toast("Saved!")}.bind(this)),e&&e(),console.log(Mute.muteMode,Mute.exemptDomains)},sendMessage:function(e){var t=this;chrome.tabs.query({active:!0,currentWindow:!0},function(e){chrome.tabs.sendMessage(e[0].id,t.getSettings())})}}};Mute.init=function(){Object.keys(Mute.ev).forEach(function(e){var t=e.split(" ")[0],u=e.split(" ").splice(1).join(" "),n=Mute.f[Mute.ev[e]].bind(Mute.f);MuteUtils.eventAdder(u,t,n)}),Mute.f.getSettings(),Mute.f.setDomainName(),Mute.f.render(),Mute.f.sendMessage(),console.info("Mute initialized")},Mute.init();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIiwibWFpbi5qcyJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYmluZCIsIiQkIiwicXVlcnlTZWxlY3RvckFsbCIsIk11dGVVdGlscyIsInNlbGVjdG9yIiwiZXZlbnROYW1lIiwiY2FsbGJhY2siLCJ0TGVuZ3RoIiwidGFyZ2V0cyIsImV2ZW50QWRkZXIiLCJsZW5ndGgiLCJpIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV4dGVuZE9iamVjdCIsIm9iaiIsImVsIiwiZm9yRWFjaCIsImtleSIsImdldExvY2F0aW9uIiwiYm91bmRpbmdDbGllbnRSZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwibGVmdCIsIndpZHRoIiwicmlnaHQiLCJub2RlTGlzdFRvQXJyYXkiLCJub2RlTGlzdCIsIkFycmF5IiwicHJvdG90eXBlIiwic2xpY2UiLCJjYWxsIiwiTXV0ZSIsIm11dGVNb2RlIiwiZXhlbXB0RG9tYWlucyIsImV4Y2x1ZGVPbkJ1dHRvbiIsImV4Y2x1ZGVPZmZCdXR0b24iLCJldiIsImNsaWNrIC5leGNsdWRlciAub24iLCJjbGljayAuZXhjbHVkZXIgLm9mZiIsImNsaWNrIC5tdXRlciAubXV0ZSIsImNsaWNrIC5tdXRlciAuc3RvcCIsImYiLCJzZXREb21haW5OYW1lIiwiY2hyb21lIiwidGFicyIsInF1ZXJ5IiwidXJsIiwiY3JlYXRlRWxlbWVudCIsImEiLCJzZXRBdHRyaWJ1dGUiLCJjdXJyZW50RG9tYWluIiwidG9hc3QiLCJtZXNzYWdlIiwiZXhjbHVkZVNpdGUiLCJldnQiLCJpbmRleE9mIiwicHVzaCIsInRoaXMiLCJyZW5kZXIiLCJpbmNsdWRlU2l0ZSIsImluZGV4Iiwic3BsaWNlIiwic2V0TXV0ZSIsInNldFN0b3AiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJtdXRlQnV0dG9uIiwiYWRkIiwic3RvcEJ1dHRvbiIsImdldFNldHRpbmdzIiwic3RvcmFnZSIsInN5bmMiLCJnZXQiLCJyZWNvcmQiLCJzZXRTZXR0aW5ncyIsInNldCIsImNvbnNvbGUiLCJzZW5kTWVzc2FnZSIsIl90aGlzIiwiY3VycmVudFdpbmRvdyIsImlkIiwiaW5pdCIsIk9iamVjdCIsImtleXMiLCJpZGVudGlmaWVyIiwic3BsaXQiLCJqb2luIiwiZm4iLCJpbmZvIl0sIm1hcHBpbmdzIjoiWUFBQSxJQUFJQSxHQUFJQyxTQUFTQyxjQUFjQyxLQUFLRixVQUNoQ0csR0FBS0gsU0FBU0ksaUJBQWlCRixLQUFLRixVQUFwQ0csV0FFQUUsV0FBWSxTQUFBQyxFQUFBQyxFQUFBQyxHQUdSLElBQ0lDLEdBREFDLEdBQVVQLEdBQUdHLE9BRHJCSyxFQUFZRCxFQUFBRSxPQUVKSCxFQUFBQSxFQUFVQyxFQUFBQSxFQURkRyxJQUlJSCxFQUFRRyxHQUFHQyxpQkFBaUJQLEVBQVdDLEVBQzFDLE9BQUFFLElBR0pLLGFBWFcsU0FBQUMsRUFBQUMsR0FpQlAsTUFKTEYsUUFBQUEsS0FBY0UsR0FBQUMsUUFBQSxTQUFTRixHQUdmQSxFQUFJRyxHQUFPRixFQUFHRSxLQURsQkgsR0FRSkksWUFBYSxTQUFTSCxHQUVsQixHQUFJSSxHQUFxQkosRUFBR0ssdUJBTzVCLE9BTEFQLGNBQWFNLEdBQWJOLE1BQUFBLEVBQWFNLE1BQW9CQSxFQUFBRSxLQUM3QkMsT0FBT0gsRUFBbUJJLE9BQVFKLEVBQW1CRSxNQUlsREYsR0FJWEssZ0JBQWlCLFNBQUFDLEdBQ2IsTUFBT0MsT0FBTUMsVUFBVUMsTUFBTUMsS0FBS0o7WUN4QzFDLElBQUlLLE9BRUFDLFNBQUEsRUFDQUMsaUJBQ0FELGNBSk8sS0FTUGhCLElBREFrQixnQkFBQXBDLEVBQUEsaUJBQ0lxQyxpQkFBQXJDLEVBQUEsa0JBQ0FvQyxXQUFBQSxFQUFBQSxnQkFDQUMsV0FBQUEsRUFBQUEsaUJBTUpDLElBREFDLHNCQUFBLGNBQ0lDLHVCQUFBLGNBQ0FDLHFCQUFBLFVBQ0FDLHFCQUFBLFdBTUpDLEdBREFDLGNBQUEsU0FBQW5DLEdBRUltQyxHQUFBQSxHQUFBQSxNQUNJQyxRQUFBQyxLQUFB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LEVBQUFDLGdCQVdBWCxLQUFLVSxFQUFFaUIsU0FEUDNCLEtBQUtVLEVBQUVDLGNBTVBrQyxRQUFRWSxLQUFLLHFCQUFiWixLQUFBQSIsImZpbGUiOiJqcy9tYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciAkID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvci5iaW5kKGRvY3VtZW50KSxcbiAgICAkJCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwuYmluZChkb2N1bWVudCk7XG5cbnZhciBNdXRlVXRpbHMgPSB7XG5cbiAgICBldmVudEFkZGVyOiBmdW5jdGlvbihzZWxlY3RvciwgZXZlbnROYW1lLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgdGFyZ2V0cyA9ICQkKHNlbGVjdG9yKSB8fCBbXSxcbiAgICAgICAgICAgIHRMZW5ndGggPSB0YXJnZXRzLmxlbmd0aDtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGFyZ2V0c1tpXS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgY2FsbGJhY2spO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfSxcblxuICAgIGV4dGVuZE9iamVjdDogZnVuY3Rpb24ob2JqLCBlbCkge1xuXG4gICAgICAgIE9iamVjdC5rZXlzKGVsKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgb2JqW2tleV0gPSBlbFtrZXldO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gb2JqO1xuXG4gICAgfSxcblxuICAgIGdldExvY2F0aW9uOiBmdW5jdGlvbihlbCkge1xuXG4gICAgICAgIHZhciBib3VuZGluZ0NsaWVudFJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICBleHRlbmRPYmplY3QoYm91bmRpbmdDbGllbnRSZWN0LCB7XG4gICAgICAgICAgICB3aWR0aDogYm91bmRpbmdDbGllbnRSZWN0LnJpZ2h0IC0gYm91bmRpbmdDbGllbnRSZWN0LmxlZnQsXG4gICAgICAgICAgICBoZWlnaHQ6IGJvdW5kaW5nQ2xpZW50UmVjdC5ib3R0b20gLSBib3VuZGluZ0NsaWVudFJlY3QudG9wXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBib3VuZGluZ0NsaWVudFJlY3Q7XG5cbiAgICB9LFxuXG4gICAgbm9kZUxpc3RUb0FycmF5OiBmdW5jdGlvbihub2RlTGlzdCkge1xuICAgICAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwobm9kZUxpc3QpO1xuICAgIH1cblxufTtcbiIsInZhciBNdXRlID0ge1xuXG4gICAgLy8gbXV0ZU1vZGUgMCBpcyBqdXN0IG11dGUsXG4gICAgLy8gbXV0ZU1vZGUgMSBpcyBtdXRlIGFuZCBzdG9wXG4gICAgbXV0ZU1vZGU6IDAsXG4gICAgZXhlbXB0RG9tYWluczogW10sXG4gICAgY3VycmVudERvbWFpbjogbnVsbCxcblxuICAgIC8vIGVsZW1lbnRzXG4gICAgZWw6IHtcbiAgICAgICAgZXhjbHVkZU9uQnV0dG9uOiAkKFwiLmV4Y2x1ZGVyIC5vblwiKSxcbiAgICAgICAgZXhjbHVkZU9mZkJ1dHRvbjogJChcIi5leGNsdWRlciAub2ZmXCIpLFxuICAgICAgICBtdXRlQnV0dG9uOiAkKFwiLm11dGVyIC5tdXRlXCIpLFxuICAgICAgICBzdG9wQnV0dG9uOiAkKFwiLm11dGVyIC5zdG9wXCIpXG4gICAgfSxcblxuICAgIC8vIGV2ZW50c1xuICAgIGV2OiB7XG4gICAgICAgIFwiY2xpY2sgLmV4Y2x1ZGVyIC5vblwiOiBcImV4Y2x1ZGVTaXRlXCIsXG4gICAgICAgIFwiY2xpY2sgLmV4Y2x1ZGVyIC5vZmZcIjogXCJpbmNsdWRlU2l0ZVwiLFxuICAgICAgICBcImNsaWNrIC5tdXRlciAubXV0ZVwiOiBcInNldE11dGVcIixcbiAgICAgICAgXCJjbGljayAubXV0ZXIgLnN0b3BcIjogXCJzZXRTdG9wXCJcbiAgICB9LFxuXG4gICAgLy8gZnVuY3Rpb25zXG4gICAgZjoge1xuICAgICAgICBzZXREb21haW5OYW1lOiBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgICAgICAgLy8gZ2V0IHdpbmRvdyBkb21haW4gbmFtZVxuICAgICAgICAgICAgbGV0IHVybDtcbiAgICAgICAgICAgIGNocm9tZS50YWJzLnF1ZXJ5KHtcbiAgICAgICAgICAgICAgICBcImFjdGl2ZVwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwibGFzdEZvY3VzZWRXaW5kb3dcIjogdHJ1ZVxuICAgICAgICAgICAgfSwgdGFicyA9PiB7XG4gICAgICAgICAgICAgICAgdXJsID0gdGFic1swXS51cmw7XG5cbiAgICAgICAgICAgICAgICBsZXQgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICAgICAgICAgICAgICBhLnNldEF0dHJpYnV0ZSgnaHJlZicsIHVybCk7XG4gICAgICAgICAgICAgICAgTXV0ZS5jdXJyZW50RG9tYWluID0gYS5ob3N0bmFtZTtcblxuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHRvYXN0OiBmdW5jdGlvbihtZXNzYWdlKSB7XG4gICAgICAgICAgIC8vIHBvcCB1cCBhIHRvYXN0XG4gICAgICAgIH0sXG5cbiAgICAgICAgZXhjbHVkZVNpdGU6IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICAgICAgaWYgKE11dGUuY3VycmVudERvbWFpbiAmJiBNdXRlLmV4ZW1wdERvbWFpbnMuaW5kZXhPZihNdXRlLmN1cnJlbnREb21haW4pID09IC0xKSBNdXRlLmV4ZW1wdERvbWFpbnMucHVzaChNdXRlLmN1cnJlbnREb21haW4pO1xuXG4gICAgICAgICAgICB0aGlzLnNldFNldHRpbmdzKCk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGluY2x1ZGVTaXRlOiBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICAgIGlmICghTXV0ZS5jdXJyZW50RG9tYWluKSByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBpbmRleCA9IE11dGUuZXhlbXB0RG9tYWlucy5pbmRleE9mKE11dGUuY3VycmVudERvbWFpbik7XG4gICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkgTXV0ZS5leGVtcHREb21haW5zLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAgICAgICAgIHRoaXMuc2V0U2V0dGluZ3MoKTtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0TXV0ZTogZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgICAgICBNdXRlLm11dGVNb2RlID0gMDtcblxuICAgICAgICAgICAgdGhpcy5zZXRTZXR0aW5ncygpO1xuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRTdG9wOiBmdW5jdGlvbihldnQpIHtcbiAgICAgICAgICAgIE11dGUubXV0ZU1vZGUgPSAxO1xuXG4gICAgICAgICAgICB0aGlzLnNldFNldHRpbmdzKCk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKE11dGUubXV0ZU1vZGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIE11dGUuZWwuc3RvcEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgICAgICBNdXRlLmVsLm11dGVCdXR0b24uY2xhc3NMaXN0LmFkZChcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBNdXRlLmVsLm11dGVCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImFjdGl2ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgTXV0ZS5lbC5zdG9wQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoTXV0ZS5jdXJyZW50RG9tYWluICYmIE11dGUuZXhlbXB0RG9tYWlucy5pbmRleE9mKE11dGUuY3VycmVudERvbWFpbikgPiAtMSkge1xuICAgICAgICAgICAgICAgIE11dGUuZWwuZXhjbHVkZU9mZkJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgIE11dGUuZWwuZXhjbHVkZU9uQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIE11dGUuZWwuZXhjbHVkZU9uQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICAgICAgTXV0ZS5lbC5leGNsdWRlT2ZmQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJhY3RpdmVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0U2V0dGluZ3M6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLmdldCh7XG4gICAgICAgICAgICAgICAgbXV0ZU1vZGU6IDAsXG4gICAgICAgICAgICAgICAgZXhlbXB0RG9tYWluczogW11cbiAgICAgICAgICAgIH0sIHJlY29yZCA9PiB7XG4gICAgICAgICAgICAgICAgTXV0ZS5tdXRlTW9kZSA9IHJlY29yZC5tdXRlTW9kZTtcbiAgICAgICAgICAgICAgICBNdXRlLmV4ZW1wdERvbWFpbnMgPSByZWNvcmQuZXhlbXB0RG9tYWlucztcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKCk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbXV0ZU1vZGU6IE11dGUubXV0ZU1vZGUsXG4gICAgICAgICAgICAgICAgZXhlbXB0RG9tYWluczogTXV0ZS5leGVtcHREb21haW5zXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIHNldFNldHRpbmdzOiBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgICAgICAgIGNocm9tZS5zdG9yYWdlLnN5bmMuc2V0KHtcbiAgICAgICAgICAgICAgbXV0ZU1vZGU6IE11dGUubXV0ZU1vZGUsXG4gICAgICAgICAgICAgIGV4ZW1wdERvbWFpbnM6IE11dGUuZXhlbXB0RG9tYWluc1xuICAgICAgICAgIH0sIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIHRoaXMudG9hc3QoXCJTYXZlZCFcIilcbiAgICAgICAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgICAgICAgaWYgKGNhbGxiYWNrKSBjYWxsYmFjaygpO1xuXG4gICAgICAgICAgY29uc29sZS5sb2coTXV0ZS5tdXRlTW9kZSwgTXV0ZS5leGVtcHREb21haW5zKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZW5kTWVzc2FnZTogZnVuY3Rpb24obWVzc2FnZSkge1xuICAgICAgICAgICAgY2hyb21lLnRhYnMucXVlcnkoe1xuICAgICAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjdXJyZW50V2luZG93OiB0cnVlXG4gICAgICAgICAgICB9LCB0YWJzID0+IHtcbiAgICAgICAgICAgICAgICBjaHJvbWUudGFicy5zZW5kTWVzc2FnZSh0YWJzWzBdLmlkLCB0aGlzLmdldFNldHRpbmdzKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbn07XG5cbk11dGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgLy8gYWRkIGV2ZW50IGxpc3RlbmVyc1xuICAgIE9iamVjdC5rZXlzKE11dGUuZXYpLmZvckVhY2goZnVuY3Rpb24oaWRlbnRpZmllcikge1xuICAgICAgICB2YXIgZXZlbnROYW1lID0gaWRlbnRpZmllci5zcGxpdChcIiBcIilbMF0sXG4gICAgICAgICAgICBzZWxlY3RvciA9IGlkZW50aWZpZXIuc3BsaXQoXCIgXCIpLnNwbGljZSgxKS5qb2luKFwiIFwiKSxcbiAgICAgICAgICAgIGZuID0gTXV0ZS5mW011dGUuZXZbaWRlbnRpZmllcl1dLmJpbmQoTXV0ZS5mKTtcblxuICAgICAgICBNdXRlVXRpbHMuZXZlbnRBZGRlcihzZWxlY3RvciwgZXZlbnROYW1lLCBmbik7XG4gICAgfSk7XG5cbiAgICAvLyByZWFkIGFuZCBhcHBseSBzZXR0aW5nc1xuICAgIE11dGUuZi5nZXRTZXR0aW5ncygpO1xuICAgIE11dGUuZi5zZXREb21haW5OYW1lKCk7XG4gICAgTXV0ZS5mLnJlbmRlcigpO1xuXG4gICAgLy8gdHJhbnNmZXJyaW5nIGNvbW11bmljYWJsZSBkYXRhIGFib3V0IGVhY2ggc2l0ZVxuICAgIE11dGUuZi5zZW5kTWVzc2FnZSgpO1xuXG4gICAgY29uc29sZS5pbmZvKFwiTXV0ZSBpbml0aWFsaXplZFwiKTtcblxufTtcblxuTXV0ZS5pbml0KCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
