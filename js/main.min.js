var $=document.querySelector.bind(document),$$=document.querySelectorAll.bind(document),MuteUtils={eventAdder:function(a,b,c){var d=$$(a)||[],e=d.length;for(i=0;i<e;i++)d[i].addEventListener(b,c);return d},extendObject:function(a,b){return Object.keys(b).forEach(function(c){a[c]=b[c]}),a},getLocation:function(a){var b=a.getBoundingClientRect();return extendObject(b,{width:b.right-b.left,height:b.bottom-b.top}),b},noteListToArray:function(a){return Array.prototype.slice.call(a)}};
var Mute={muteMode:0,exemptDomains:[],currentDomain:null,el:{excludeOnButton:$(".excluder .on"),excludeOffButton:$(".excluder .off"),muteButton:$(".muter .mute"),stopButton:$(".muter .stop")},ev:{"excludeOnButton click":"excludeSite","excludeOffButton click":"includeSite","muteButton click":"setMute","stopButton click":"setStop"},f:{setDomainName:function(a){var b=this;chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(a){b.currentDomain=a[0].url.match(/^(?:https?:\/\/)?(?:[^@\/\n]+@)?(?:www\.)?([^:\/\n]+)/)[0]})},toast:function(a){},excludeSite:function(a){this.currentDomain&&-1==exemptDomains.indexOf(this.currentDomain)&&this.exemptDomains.push(this.currentdomain),this.setSettings(),this.render()},includeSite:function(a){if(this.currentDomain){var b=exemptDomains.indexOf(this.currentDomain);b>-1&&this.exemptDomains.split(b,1),this.setSettings(),this.render()}},setMute:function(a){this.muteMode=0,this.setSettings(),this.render()},setStop:function(a){this.muteMode=1,this.setSettings(),this.render()},render:function(){switch(muteMode){case 0:this.el.stopButton.classList.remove("active"),this.el.muteButton.classList.add("active");break;case 1:this.el.muteButton.classList.remove("active"),this.el.stopButton.classList.add("active")}this.currentDomain&&exemptDomains.indexOf(this.currentDomain)>-1?(this.el.excludeOffButton.classList.remove("active"),this.el.excludeOnButon.classList.add("active")):(this.el.excludeOnButton.classList.remove("active"),this.el.excludeOffButon.classList.add("active"))},getSettings:function(){return chrome.storage.sync.get({muteMode:this.muteMode,exemptDomains:this.exemptDomains},function(a){this.muteMode=a.muteMode,this.exemptDomains=a.muteMode}),{muteMode:this.muteMode,exemptDomains:this.exemptDomains}},setSettings:function(){chrome.storage.sync.set({muteMode:this.muteMode,exemptDomains:this.exemptDomains},function(){this.toast("Saved!")})},sendMessage:function(a){chrome.runtime.sendMessage(this.getSettings())}}};Mute.init=function(){Object.keys(Mute.ev).forEach(function(a){var b=a.split(" ")[0],c=a.split(" ").splice(1).join(" "),d=Mute.f[Mute.ev[a]];MuteUtils.eventAdder(c,b,d)}),Mute.f.getSettings(),this.setDomainName(),Mute.f.render(),Mute.f.sendMessage(),console.info("Mute initialized")},Mute.init();